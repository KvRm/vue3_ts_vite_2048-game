import{d as E,_ as R,c as w,a as p,n as V,b as Y,r as S,o as C,e as I,f as L,g as h,w as J,h as y,i as g,t as x,j as Z,F as q,k as F,l as U,m as j,p as K}from"./index.810422a8.js";const Q=E({name:"SvgIcon",props:{name:{type:String,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},active:{type:Boolean}}});function ee(e,t,n,o,r,a){const s=S("font-awesome-icon");return C(),w("span",{class:Y(["icon-container",{active:e.active}])},[p(s,{icon:`fa-solid fa-${e.name}`,class:"icon",style:V({width:e.width,height:e.height})},null,8,["icon","style"])],2)}const M=R(Q,[["render",ee],["__scopeId","data-v-39b8d90b"]]);var v=(e=>(e.THEME="THEME",e.GAME_CONTROLLER="GAME_CONTROLLER",e.CELLS="CELLS",e.GAME_STATE="GAME_STATE",e.CURRENT_SCORE="CURRENT_SCORE",e.RECORD_SCORE="RECORD_SCORE",e))(v||{});const N=()=>({get:r=>window.localStorage.getItem(r),set:(r,a)=>window.localStorage.setItem(r,a),remove:r=>window.localStorage.removeItem(r),reset:()=>window.localStorage.clear()}),W=()=>{const e=l=>l.map(c=>c.map(d=>d)),t=l=>{let c=[];for(let d=0;d<l.length;d++){let m=[];for(let i=0;i<l.length;i++)m.push(l[i][d]);c.push(m)}return c},n=l=>l.map(c=>c.filter(d=>d!==0)),o=(l,c)=>{const d=H(),m=l;return c==="start"&&m.forEach(i=>{for(let _=0;_<i.length;_++)i[_]===i[_+1]&&(i[_]*=2,i[_+1]=0,d.increaseCurrentScore(i[_]))}),c==="end"&&m.forEach(i=>{for(let _=i.length-1;_>=0;_--)i[_]===i[_-1]&&(i[_]*=2,i[_-1]=0,d.increaseCurrentScore(i[_]))}),m},r=(l,c)=>{const d=l;return c==="start"&&l.forEach(m=>{for(;m.length<4;)m.push(0)}),c==="end"&&l.forEach(m=>{for(;m.length<4;)m.unshift(0)}),d},a=l=>{let c=l;const d=m(l);if(d.length){const i=f(d),_=u(),O=d[i][0],G=d[i][1];c[O][G]=_}return c;function m(i){const _=[];for(let O=0;O<i.length;O++)for(let G=0;G<i.length;G++)i[O][G]===0&&_.push([O,G]);return _}},s=()=>{const l=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],c=[];for(let m=0;c.length<2;m++){const i=d(3),_=d(3);c.length<1?c.push([i,_]):i!==c[0][0]&&_!==c[0][1]&&c.push([i,_])}for(let m of c){const i=m[0],_=m[1];l[i][_]=u()}return l;function d(m){return Math.floor(Math.random()*(Math.floor(m)+1))}};function u(){return Math.random()>.2?2:4}function f(l){const c=l.length-1;return Math.floor(Math.random()*(Math.floor(c)+1))}return{getCells:e,getReversedCells:t,getCellsWithoutZeros:n,getCellsWithZeros:r,getUnitedCells:o,getCellsWithNewRandomNumber:a,getStaterCells:s}},b=N(),D=I("game",()=>{const e=L("active"),t=h(()=>e.value);return{gameState:e,getGameState:t,setGameState:o=>{e.value=o,b.set(v.GAME_STATE,e.value)}}}),k=I("cells",()=>{const e=L([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),t=L(e.value),n=h(()=>e.value),o=s=>{t.value=e.value,e.value=s,b.set(v.CELLS,JSON.stringify(s))};return{cells:e,prevCells:t,getCells:n,setCells:o,setStarterCells:()=>{const s=H(),{getStaterCells:u}=W();e.value=u(),b.set(v.CELLS,JSON.stringify(e.value)),s.resetScore()},setPrevCells:()=>{o(t.value)}}}),B=I("controller",()=>{const e=L("keyboard"),t=h(()=>e.value);return{controller:e,getController:t,setController:o=>{e.value=o,b.set(v.GAME_CONTROLLER,e.value)}}}),H=I("score",()=>{const e=L(0),t=L(0),n=h(()=>e.value),o=h(()=>t.value);J(e,()=>{e.value>t.value&&a(e.value)});const r=f=>{e.value=f,b.set(v.CURRENT_SCORE,JSON.stringify(e.value))},a=f=>{t.value=f,b.set(v.RECORD_SCORE,JSON.stringify(t.value))};return{currentScore:e,recordScore:t,getCurrentScore:n,getRecordScore:o,setCurrentScore:r,setRecordScore:a,increaseCurrentScore:f=>{e.value+=f,b.set(v.CURRENT_SCORE,JSON.stringify(e.value))},resetScore:()=>{e.value=0,b.set(v.CURRENT_SCORE,JSON.stringify(e.value))}}}),te=E({components:{SvgIcon:M},setup(){const e=N(),t=k(),n=D(),o=H(),r=h(()=>o.getCurrentScore),a=h(()=>o.getRecordScore);return y(()=>{if(e.get(v.CURRENT_SCORE)){const f=e.get(v.CURRENT_SCORE);Number(f)&&o.setCurrentScore(Number(f))}if(e.get(v.RECORD_SCORE)){const f=e.get(v.RECORD_SCORE);Number(f)&&o.setRecordScore(Number(f))}}),{currentScore:r,recordScore:a,restartGame:()=>{t.setStarterCells(),n.setGameState("active")},setPrevStep:()=>{t.setPrevCells(),n.setGameState("active")}}}});const ne={class:"header"},oe=g("h1",{class:"title"},"2048",-1),re={class:"score"},se=g("span",{class:"score-header"},"Current score: ",-1),ce={class:"score-value"},ae={class:"score record"},le=g("span",{class:"score-header record-header"},"Record: ",-1),ie={class:"score-value record-value"},ue={class:"controllers"};function de(e,t,n,o,r,a){const s=S("svg-icon");return C(),w("div",ne,[oe,g("div",re,[se,g("p",ce,x(e.currentScore),1)]),g("div",ae,[le,g("p",ie,x(e.recordScore),1)]),g("div",ue,[p(s,{onClick:e.setPrevStep,name:"backward",height:26,width:26},null,8,["onClick"]),p(s,{onClick:e.restartGame,name:"rotate-right",height:26,width:26},null,8,["onClick"])])])}const me=R(te,[["render",de]]),fe=E({props:{value:{type:Number,required:!0}},setup(e){const t=h(()=>e.value===0?"":e.value),n=h(()=>e.value===2?"first":e.value===4?"second":e.value===8?"third":e.value===16?"fourth":e.value===32?"fifth":e.value===64?"sixth":e.value===128?"seventh":e.value===256?"eighth":e.value===512?"ninth":e.value===1024?"tenth":e.value===2048?"eleventh":e.value===4096?"twelfth":e.value===8192?"thirteenth":e.value===16384?"fourteenth":e.value===32768?"fifteenth":"empty");return{number:t,color:n}}});const ve={class:"number-container"};function _e(e,t,n,o,r,a){return C(),w("div",ve,[g("div",{class:Y(["number",e.color])},x(e.number),3)])}const he=R(fe,[["render",_e],["__scopeId","data-v-bb39c988"]]),ge=(e,t)=>{let o,r;return"clientX"in e?(o=e==null?void 0:e.clientX,r=e==null?void 0:e.clientY):(o=e==null?void 0:e.touches[0].clientX,r=e==null?void 0:e.touches[0].clientY),t.startX-o>=90?"left":t.startX-o<=-90?"right":t.startY-r>=90?"up":t.startY-r<=-90?"down":null},$=e=>{const t=k(),n=h(()=>t.getCells),{getReversedCells:o}=W();switch(e){case"left":return r(n.value,"left");case"right":return r(n.value,"right");case"up":{const a=o(n.value);return r(a,"up")}case"down":{const a=o(n.value);return r(a,"down")}}function r(a,s){if(s==="left"||s==="up"){for(let c of a)if(u(c)||l(c))return!0}else if(s==="right"||s==="down"){for(let c of a)if(f(c)||l(c))return!0}return!1;function u(c){const d=c.indexOf(0);let m=-1;for(let i=0;i<c.length;i++)c[i]&&(m=i);return m!==-1&&d!==-1?m>d:!1}function f(c){const d=c.lastIndexOf(0);let m=-1;for(let i=c.length-1;i>=0;i--)c[i]&&(m=i);return m!==-1&&d!==-1?m<d:!1}function l(c){for(let d=1;d<c.length;d++)if(c[d]===c[d-1]&&c[d]!==0)return!0;return!1}}return!1},Ce=()=>({swipeLeft:()=>A("left"),swipeRight:()=>A("right"),swipeUp:()=>A("up"),swipeDown:()=>A("down")});function A(e){const t=k(),n=h(()=>t.getCells),{getCells:o,getReversedCells:r,getCellsWithoutZeros:a,getCellsWithZeros:s,getUnitedCells:u,getCellsWithNewRandomNumber:f}=W();let l,c;e==="up"||e==="down"?l=r(n.value):l=o(n.value),e==="left"||e==="up"?c="start":c="end",l=a(l),l=u(l,c),l=a(l),l=s(l,c),(e==="up"||e==="down")&&(l=r(l)),l=f(l),t.setCells(l)}const P=e=>{const{swipeLeft:t,swipeRight:n,swipeUp:o,swipeDown:r}=Ce(),a=D();switch(e){case"left":$("left")&&t();break;case"right":$("right")&&n();break;case"up":$("up")&&o();break;case"down":$("down")&&r();break}!$("left")&&!$("right")&&!$("up")&&!$("down")&&a.setGameState("over")},T=(e,t)=>{const n=B(),o=h(()=>n.getController);if(o.value==="keyboard")"code"in e&&!e.ctrlKey&&pe(e);else if(o.value==="mouse"){let r=0,a=0;"clientX"in e?(r=e.clientX,a=e.clientY):"touches"in e&&(r=e==null?void 0:e.touches[0].clientX,a=e==null?void 0:e.touches[0].clientY);const s=u=>{const f=ge(u,{startX:r,startY:a});f&&(P(f),t.removeEventListener("mousemove",s,!1),t.removeEventListener("touchmove",s,!1))};t.addEventListener("mousemove",s),t.addEventListener("touchmove",s),t.onmouseup=()=>{t.removeEventListener("mousemove",s),t.onmouseup=null},t.ontouchend=()=>{t.removeEventListener("touchmove",s),t.ontouchend=null}}},pe=e=>{let t=null;(e.code==="ArrowUp"||e.code==="KeyW")&&(t="up"),(e.code==="ArrowRight"||e.code==="KeyD")&&(t="right"),(e.code==="ArrowDown"||e.code==="KeyS")&&(t="down"),(e.code==="ArrowLeft"||e.code==="KeyA")&&(t="left"),t&&P(t)},Se=E({components:{NumberComponent:he},setup(){const e=N(),t=k(),n=L(null),o=h(()=>t.getCells),r=h(()=>o.value.reduce((a,s)=>[...a,...s],[]));return y(()=>{var a,s,u;e.get(v.CELLS)?t.setCells(JSON.parse(e.get(v.CELLS))):t.setStarterCells(),(a=n.value)==null||a.addEventListener("mousedown",f=>T(f,n.value)),(s=n.value)==null||s.addEventListener("touchstart",f=>T(f,n.value)),window.addEventListener("keydown",f=>T(f,n.value)),(u=n.value)==null||u.addEventListener("dragstart",()=>!1)}),Z(()=>{var a,s,u;(a=n.value)==null||a.removeEventListener("mousedown",()=>T,!1),(s=n.value)==null||s.removeEventListener("touchstart",()=>T,!1),(u=n.value)==null||u.removeEventListener("dragstart",()=>!1,!1)}),{playgroundCells:r,cells:o,playgroundRef:n}}});const we={class:"game-over",ref:"playgroundRef"};function Ee(e,t,n,o,r,a){const s=S("number-component");return C(),w("div",we,[(C(!0),w(q,null,F(e.playgroundCells,(u,f)=>(C(),U(s,{key:f,value:u},null,8,["value"]))),128))],512)}const X=R(Se,[["render",Ee]]),Re=()=>({addListener:n=>{window.addEventListener("resize",()=>n(window.innerWidth))},removeListener:n=>{window.removeEventListener("resize",()=>n(window.innerWidth))}}),$e=E({components:{SvgIcon:M},setup(){const e=B(),t=N(),n=L(window.innerWidth),o=h(()=>e.controller),{removeListener:r,addListener:a}=Re();y(()=>{if(a(u=>n.value=u),t.get(v.GAME_CONTROLLER)==="keyboard"||t.get(v.GAME_CONTROLLER)==="mouse"){const u=t.get(v.GAME_CONTROLLER);e.setController(u)}}),Z(()=>r(u=>n.value=u));const s=u=>{e.setController(u)};return J(n,()=>{n.value<=540?e.setController("mouse"):e.setController("keyboard")}),{controller:o,screenWidth:n,switchController:s}}});const be={key:0,class:"controllers"};function Le(e,t,n,o,r,a){const s=S("svg-icon");return e.screenWidth>540?(C(),w("div",be,[g("span",{onClick:t[0]||(t[0]=u=>e.switchController("keyboard"))},[p(s,{height:30,width:30,name:"keyboard",active:e.controller==="keyboard"},null,8,["active"])]),g("span",{onClick:t[1]||(t[1]=u=>e.switchController("mouse"))},[p(s,{height:30,width:30,name:"computer-mouse",active:e.controller==="mouse"},null,8,["active"])])])):j("",!0)}const Ne=R($e,[["render",Le],["__scopeId","data-v-24345df0"]]),Oe=E({components:{SvgIcon:M},setup(){const e=k(),t=D();return{restartGame:()=>{e.setStarterCells(),t.setGameState("active")}}}});const Ge={class:"game-over-banner"},Te=g("span",{class:"game-over-banner__text"},"Game Over",-1);function ye(e,t,n,o,r,a){const s=S("svg-icon");return C(),w("div",Ge,[Te,p(s,{onClick:e.restartGame,name:"rotate-right",height:80,width:80},null,8,["onClick"])])}const z=R(Oe,[["render",ye]]),Me=E({components:{SvgIcon:M,GameHeader:me,GamePlayground:X,GameController:Ne,GameOver:z},setup(){const e=D(),t=N(),n=h(()=>e.getGameState),o=h(()=>n.value==="over"?z:X);return y(()=>{if(t.get(v.GAME_STATE)==="active"||t.get(v.GAME_STATE)==="over"){const r=t.get(v.GAME_STATE);e.setGameState(r)}}),{gameState:n,gameComponent:o}}});const ke={class:"game"};function Ae(e,t,n,o,r,a){const s=S("game-header"),u=S("game-controller");return C(),w("div",ke,[p(s),(C(),U(K(e.gameComponent))),p(u)])}const Ie=R(Me,[["render",Ae],["__scopeId","data-v-939e11b3"]]),De=E({name:"ThemeSwitcher",components:{SvgIcon:M},setup(){const e=N();y(()=>{n()});const t=()=>{e.get(v.THEME)==="light"?e.set(v.THEME,"dark"):e.set(v.THEME,"light"),n()},n=()=>{const r=N();r.get(v.THEME)?r.get(v.THEME)==="dark"?o("dark"):o("light"):window!=null&&window.matchMedia("(prefers-color-scheme: light)").matches?(r.set(v.THEME,"light"),o("light"),n()):(r.set(v.THEME,"dark"),o("dark"),n())},o=r=>{document.documentElement.setAttribute("data-theme",r)};return{switchTheme:t}}});function xe(e,t,n,o,r,a){const s=S("svg-icon");return C(),U(s,{onClick:e.switchTheme,name:"lightbulb",width:40,height:40},null,8,["onClick"])}const Ue=R(De,[["render",xe]]),We=E({name:"MainView",components:{ThemeSwitcher:Ue,GameContainer:Ie}}),He={class:"main"};function Xe(e,t,n,o,r,a){const s=S("theme-switcher"),u=S("game-container");return C(),w("main",He,[p(s),p(u)])}const Ye=R(We,[["render",Xe]]);export{Ye as default};
