import{d as $,_ as b,c as E,a as w,n as j,b as B,r as C,o as p,e as I,f as S,g as h,w as P,h as D,i as Y,j as g,t as W,F as K,k as Q,l as U,m as z}from"./index.c18a9369.js";const ee=$({name:"SvgIcon",props:{name:{type:String,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},active:{type:Boolean},disabled:{type:Boolean},transparentHover:{type:Boolean}}});function te(e,t,r,n,c,d){const a=C("font-awesome-icon");return p(),E("span",{class:B(["icon-container",{active:e.active,disabled:e.disabled,hover:!e.disabled,transparentHover:e.transparentHover}])},[w(a,{icon:`fa-solid fa-${e.name}`,class:"icon",style:j({width:e.width,height:e.height})},null,8,["icon","style"])],2)}const k=b(ee,[["render",te],["__scopeId","data-v-57cf0e2e"]]),X=()=>{const e=s=>s.map(o=>o.map(u=>u)),t=s=>{let o=[];for(let u=0;u<s.length;u++){let l=[];for(let i=0;i<s.length;i++)l.push(s[i][u]);o.push(l)}return o},r=s=>s.map(o=>o.filter(u=>u!==0)),n=(s,o)=>{const u=A(),l=s;return o==="start"&&l.forEach(i=>{for(let _=0;_<i.length;_++)i[_]===i[_+1]&&(i[_]*=2,i[_+1]=0,u.increaseCurrentScore(i[_]))}),o==="end"&&l.forEach(i=>{for(let _=i.length-1;_>=0;_--)i[_]===i[_-1]&&(i[_]*=2,i[_-1]=0,u.increaseCurrentScore(i[_]))}),l},c=(s,o)=>{const u=s;return o==="start"&&s.forEach(l=>{for(;l.length<4;)l.push(0)}),o==="end"&&s.forEach(l=>{for(;l.length<4;)l.unshift(0)}),u},d=s=>{let o=s;const u=l(s);if(u.length){const i=f(u),_=v(),L=u[i][0],G=u[i][1];o[L][G]=_}return o;function l(i){const _=[];for(let L=0;L<i.length;L++)for(let G=0;G<i.length;G++)i[L][G]===0&&_.push([L,G]);return _}},a=()=>{const s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=[];for(let l=0;o.length<2;l++){const i=u(3),_=u(3);o.length<1?o.push([i,_]):i!==o[0][0]&&_!==o[0][1]&&o.push([i,_])}for(let l of o){const i=l[0],_=l[1];s[i][_]=v()}return s;function u(l){return Math.floor(Math.random()*(Math.floor(l)+1))}};function v(){return Math.random()>.2?2:4}function f(s){const o=s.length-1;return Math.floor(Math.random()*(Math.floor(o)+1))}return{getCells:e,getReversedCells:t,getCellsWithoutZeros:r,getCellsWithZeros:c,getUnitedCells:n,getCellsWithNewRandomNumber:d,getStaterCells:a}};var m=(e=>(e.THEME="THEME",e.GAME_CONTROLLER="GAME_CONTROLLER",e.CELLS="CELLS",e.GAME_STATE="GAME_STATE",e.CURRENT_SCORE="CURRENT_SCORE",e.RECORD_SCORE="RECORD_SCORE",e))(m||{});const R=()=>({get:c=>window.localStorage.getItem(c),set:(c,d)=>window.localStorage.setItem(c,d),remove:c=>window.localStorage.removeItem(c),reset:()=>window.localStorage.clear()}),M=I("cells",()=>{const e=R(),t=A(),{getStaterCells:r}=X(),n=S([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),c=h(()=>n.value),d=S(n.value),a=S(!1),v=h(()=>a.value),f=S(0),s=i=>{d.value=n.value,a.value=!0,n.value=i,e.set(m.CELLS,JSON.stringify(n.value))},o=()=>{const i=A();a.value=!1,n.value=r(),e.set(m.CELLS,JSON.stringify(n.value)),i.resetCurrentScore()},u=()=>{v.value&&(n.value=d.value,e.set(m.CELLS,JSON.stringify(n.value)),t.setPrevScore()),l(!1)},l=i=>{a.value=i};return{cells:n,prevCells:d,score:f,getCells:c,getPrevCellsState:v,setCells:s,setStarterCells:o,setPrevCells:u,setPrevCellsState:l}}),Z=I("controller",()=>{const e=R(),t=S("mouse"),r=h(()=>t.value);return{controller:t,getController:r,setController:c=>{t.value=c,e.set(m.GAME_CONTROLLER,t.value)}}}),H=I("game",()=>{const e=R(),t=S("active"),r=h(()=>t.value);return{gameState:t,getGameState:r,setGameState:c=>{t.value=c,e.set(m.GAME_STATE,t.value)}}}),A=I("score",()=>{const e=R(),t=S(0),r=S(0),n=S(0),c=h(()=>t.value),d=h(()=>r.value);P(t,()=>{t.value>r.value&&v(t.value)});const a=u=>{t.value=u,e.set(m.CURRENT_SCORE,JSON.stringify(t.value))},v=u=>{r.value=u,e.set(m.RECORD_SCORE,JSON.stringify(r.value))};return{currentScore:t,recordScore:r,getCurrentScore:c,getRecordScore:d,setCurrentScore:a,setRecordScore:v,increaseCurrentScore:u=>{n.value=t.value,a(t.value+u)},resetCurrentScore:()=>{a(0)},setPrevScore:()=>{a(n.value)}}}),ne=$({components:{SvgIcon:k},setup(){const e=R(),t=M(),r=H(),n=A(),c=h(()=>t.getPrevCellsState),d=h(()=>n.getCurrentScore),a=h(()=>n.getRecordScore),v=h(()=>r.getGameState);D(()=>{if(e.get(m.CURRENT_SCORE)){const l=e.get(m.CURRENT_SCORE);Number(l)&&n.setCurrentScore(Number(l))}if(e.get(m.RECORD_SCORE)){const l=e.get(m.RECORD_SCORE);Number(l)&&n.setRecordScore(Number(l))}window.addEventListener("keydown",l=>{s(l),f(l)})}),Y(()=>window.removeEventListener("keydown",l=>{s(l),f(l)}));const f=l=>{l.code==="Space"&&v.value==="over"&&o()},s=l=>{l.code==="Escape"&&u()},o=()=>{t.setStarterCells(),r.setGameState("active")},u=()=>{c.value&&(t.setPrevCells(),r.setGameState("active"))};return{prevCellsState:c,currentScore:d,recordScore:a,restartGame:o,setPrevStep:u}}});const oe={class:"header"},re=g("h1",{class:"title"},"2048",-1),se={class:"score"},ce=g("span",{class:"score-header"},"Current score: ",-1),ae={class:"score-value"},le={class:"score record"},ie=g("span",{class:"score-header record-header"},"Record: ",-1),ue={class:"score-value record-value"},de={class:"controllers"};function ve(e,t,r,n,c,d){const a=C("svg-icon");return p(),E("div",oe,[re,g("div",se,[ce,g("p",ae,W(e.currentScore),1)]),g("div",le,[ie,g("p",ue,W(e.recordScore),1)]),g("div",de,[w(a,{onClick:e.setPrevStep,disabled:!e.prevCellsState,name:"backward",height:26,width:26},null,8,["onClick","disabled"]),w(a,{onClick:e.restartGame,name:"rotate-right",height:26,width:26},null,8,["onClick"])])])}const me=b(ne,[["render",ve]]),fe=$({props:{value:{type:Number,required:!0}},setup(e){const t=h(()=>e.value===0?"":e.value),r=h(()=>e.value===2?"first":e.value===4?"second":e.value===8?"third":e.value===16?"fourth":e.value===32?"fifth":e.value===64?"sixth":e.value===128?"seventh":e.value===256?"eighth":e.value===512?"ninth":e.value===1024?"tenth":e.value===2048?"eleventh":e.value===4096?"twelfth":e.value===8192?"thirteenth":e.value===16384?"fourteenth":e.value===32768?"fifteenth":"empty");return{number:t,color:r}}});const _e={class:"number-container"};function he(e,t,r,n,c,d){return p(),E("div",_e,[g("div",{class:B(["number",e.color])},W(e.number),3)])}const ge=b(fe,[["render",he],["__scopeId","data-v-389bb05f"]]),pe=$({components:{SvgIcon:k},setup(){const e=M(),t=H();return{restartGame:()=>{e.setStarterCells(),t.setGameState("active")}}}});const Ce={class:"game-over-banner"},Se=g("span",{class:"game-over-banner__text"},"Game Over",-1);function we(e,t,r,n,c,d){const a=C("svg-icon");return p(),E("div",Ce,[Se,w(a,{onClick:e.restartGame,name:"rotate-right",hover:!1,"transparent-hover":!0,height:80,width:80},null,8,["onClick"])])}const J=b(pe,[["render",we]]),V=()=>{const e=S(window.innerWidth);return window.addEventListener("resize",()=>e.value=window.innerWidth),e},x=V();let N=90;q(x);P(x,()=>{q(x)});function q(e){e.value<=540?N=60:N=90}const Ee=(e,t)=>{let r,n;return"clientX"in e?(r=e==null?void 0:e.clientX,n=e==null?void 0:e.clientY):(r=e==null?void 0:e.touches[0].clientX,n=e==null?void 0:e.touches[0].clientY),t.startX-r>=N?"left":t.startX-r<=-N?"right":t.startY-n>=N?"up":t.startY-n<=-N?"down":null},y=e=>{const t=M(),r=h(()=>t.getCells),{getReversedCells:n}=X();switch(e){case"left":return c(r.value,"left");case"right":return c(r.value,"right");case"up":{const d=n(r.value);return c(d,"up")}case"down":{const d=n(r.value);return c(d,"down")}}function c(d,a){if(a==="left"||a==="up"){for(let o of d)if(v(o)||s(o))return!0}else if(a==="right"||a==="down"){for(let o of d)if(f(o)||s(o))return!0}return!1;function v(o){const u=o.indexOf(0);let l=-1;for(let i=0;i<o.length;i++)o[i]&&(l=i);return l!==-1&&u!==-1?l>u:!1}function f(o){const u=o.lastIndexOf(0);let l=-1;for(let i=o.length-1;i>=0;i--)o[i]&&(l=i);return l!==-1&&u!==-1?l<u:!1}function s(o){for(let u=1;u<o.length;u++)if(o[u]===o[u-1]&&o[u]!==0)return!0;return!1}}return!1},Re=()=>({swipeLeft:()=>T("left"),swipeRight:()=>T("right"),swipeUp:()=>T("up"),swipeDown:()=>T("down")});function T(e){const t=M(),r=h(()=>t.getCells),{getCells:n,getReversedCells:c,getCellsWithoutZeros:d,getCellsWithZeros:a,getUnitedCells:v,getCellsWithNewRandomNumber:f}=X();let s,o;e==="up"||e==="down"?s=c(r.value):s=n(r.value),e==="left"||e==="up"?o="start":o="end",s=d(s),s=v(s,o),s=d(s),s=a(s,o),(e==="up"||e==="down")&&(s=c(s)),s=f(s),t.setCells(s)}const F=e=>{const{swipeLeft:t,swipeRight:r,swipeUp:n,swipeDown:c}=Re(),d=H();switch(e){case"left":y("left")&&t();break;case"right":y("right")&&r();break;case"up":y("up")&&n();break;case"down":y("down")&&c();break}!y("left")&&!y("right")&&!y("up")&&!y("down")&&d.setGameState("over")},O=(e,t)=>{const r=Z(),n=h(()=>r.getController);if(n.value==="keyboard")"code"in e&&!e.ctrlKey&&$e(e);else if(n.value==="mouse"){let c=0,d=0;"clientX"in e?(c=e.clientX,d=e.clientY):"touches"in e&&(c=e==null?void 0:e.touches[0].clientX,d=e==null?void 0:e.touches[0].clientY);const a=v=>{const f=Ee(v,{startX:c,startY:d});f&&(F(f),t.removeEventListener("mousemove",a,!1),t.removeEventListener("touchmove",a,!1))};t.addEventListener("mousemove",a),t.addEventListener("touchmove",a),t.onmouseup=()=>{t.removeEventListener("mousemove",a),t.onmouseup=null},t.ontouchend=()=>{t.removeEventListener("touchmove",a),t.ontouchend=null}}},$e=e=>{let t=null;(e.code==="ArrowUp"||e.code==="KeyW")&&(t="up"),(e.code==="ArrowRight"||e.code==="KeyD")&&(t="right"),(e.code==="ArrowDown"||e.code==="KeyS")&&(t="down"),(e.code==="ArrowLeft"||e.code==="KeyA")&&(t="left"),t&&F(t)},be=$({components:{NumberComponent:ge,GameOver:J},setup(){const e=R(),t=M(),r=H(),n=S(null),c=h(()=>t.getCells),d=h(()=>c.value.reduce((v,f)=>[...v,...f],[])),a=h(()=>r.getGameState);return D(()=>{var v,f,s;if(e.get(m.GAME_STATE)==="active"||e.get(m.GAME_STATE)==="over"){const o=e.get(m.GAME_STATE);r.setGameState(o)}e.get(m.CELLS)?t.setCells(JSON.parse(e.get(m.CELLS))):t.setStarterCells(),t.setPrevCellsState(!1),(v=n.value)==null||v.addEventListener("mousedown",o=>O(o,n.value)),(f=n.value)==null||f.addEventListener("touchstart",o=>O(o,n.value)),window.addEventListener("keydown",o=>O(o,n.value)),(s=n.value)==null||s.addEventListener("dragstart",()=>!1)}),Y(()=>{var v,f,s;(v=n.value)==null||v.removeEventListener("mousedown",()=>O,!1),(f=n.value)==null||f.removeEventListener("touchstart",()=>O,!1),(s=n.value)==null||s.removeEventListener("dragstart",()=>!1,!1)}),{playgroundCells:d,cells:c,playgroundRef:n,gameState:a}}});const ye={class:"playground",ref:"playgroundRef"};function Le(e,t,r,n,c,d){const a=C("number-component"),v=C("game-over");return p(),E("div",ye,[(p(!0),E(K,null,Q(e.playgroundCells,(f,s)=>(p(),U(a,{key:s,value:f},null,8,["value"]))),128)),e.gameState==="over"?(p(),U(v,{key:0})):z("",!0)],512)}const Ge=b(be,[["render",Le]]),Ne=$({components:{SvgIcon:k},setup(){const e=Z(),t=R(),r=V(),n=h(()=>e.controller);D(()=>d());const c=a=>{e.setController(a)},d=()=>{if(r.value<=540)e.setController("mouse");else if(t.get(m.GAME_CONTROLLER)==="keyboard"||t.get(m.GAME_CONTROLLER)==="mouse"){const a=t.get(m.GAME_CONTROLLER);e.setController(a)}};return P(r,d),{controller:n,screenWidth:r,setController:d,switchController:c}}});const Oe={key:0,class:"controllers"};function ke(e,t,r,n,c,d){const a=C("svg-icon");return e.screenWidth>540?(p(),E("div",Oe,[g("span",{onClick:t[0]||(t[0]=v=>e.switchController("keyboard"))},[w(a,{height:30,width:30,name:"keyboard",active:e.controller==="keyboard"},null,8,["active"])]),g("span",{onClick:t[1]||(t[1]=v=>e.switchController("mouse"))},[w(a,{height:30,width:30,name:"computer-mouse",active:e.controller==="mouse"},null,8,["active"])])])):z("",!0)}const Me=b(Ne,[["render",ke],["__scopeId","data-v-027d590b"]]),Te=$({components:{SvgIcon:k,GameHeader:me,GamePlayground:Ge,GameController:Me,GameOver:J}});const Ae={class:"game"};function Ie(e,t,r,n,c,d){const a=C("game-header"),v=C("game-playground"),f=C("game-controller");return p(),E("div",Ae,[w(a),w(v),w(f)])}const De=b(Te,[["render",Ie],["__scopeId","data-v-70a7468d"]]),He=$({name:"ThemeSwitcher",components:{SvgIcon:k},setup(){const e=R();D(()=>{r()});const t=()=>{e.get(m.THEME)==="light"?e.set(m.THEME,"dark"):e.set(m.THEME,"light"),r()},r=()=>{const c=R();c.get(m.THEME)?c.get(m.THEME)==="dark"?n("dark"):n("light"):window!=null&&window.matchMedia("(prefers-color-scheme: light)").matches?(c.set(m.THEME,"light"),n("light"),r()):(c.set(m.THEME,"dark"),n("dark"),r())},n=c=>{document.documentElement.setAttribute("data-theme",c)};return{switchTheme:t}}});function We(e,t,r,n,c,d){const a=C("svg-icon");return p(),U(a,{onClick:e.switchTheme,name:"lightbulb",width:40,height:40},null,8,["onClick"])}const Ue=b(He,[["render",We]]),xe=$({name:"MainView",components:{ThemeSwitcher:Ue,GameContainer:De}}),Pe={class:"main"};function Xe(e,t,r,n,c,d){const a=C("theme-switcher"),v=C("game-container");return p(),E("main",Pe,[w(a),w(v)])}const Ye=b(xe,[["render",Xe]]);export{Ye as default};
