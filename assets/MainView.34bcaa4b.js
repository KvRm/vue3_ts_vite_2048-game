import{d as $,_ as b,c as R,a as S,n as F,b as B,r as w,o as C,e as D,f as p,g as h,w as H,h as M,i as g,t as x,j,F as K,k as Q,l as P,m as ee,p as te}from"./index.8dc4afa6.js";const ne=$({name:"SvgIcon",props:{name:{type:String,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},active:{type:Boolean},disabled:{type:Boolean}}});function oe(e,t,n,o,s,a){const r=w("font-awesome-icon");return C(),R("span",{class:B(["icon-container",{active:e.active,disabled:e.disabled}])},[S(r,{icon:`fa-solid fa-${e.name}`,class:"icon",style:F({width:e.width,height:e.height})},null,8,["icon","style"])],2)}const T=b(ne,[["render",oe],["__scopeId","data-v-b90fffe3"]]),X=()=>{const e=l=>l.map(c=>c.map(u=>u)),t=l=>{let c=[];for(let u=0;u<l.length;u++){let d=[];for(let i=0;i<l.length;i++)d.push(l[i][u]);c.push(d)}return c},n=l=>l.map(c=>c.filter(u=>u!==0)),o=(l,c)=>{const u=I(),d=l;return c==="start"&&d.forEach(i=>{for(let v=0;v<i.length;v++)i[v]===i[v+1]&&(i[v]*=2,i[v+1]=0,u.increaseCurrentScore(i[v]))}),c==="end"&&d.forEach(i=>{for(let v=i.length-1;v>=0;v--)i[v]===i[v-1]&&(i[v]*=2,i[v-1]=0,u.increaseCurrentScore(i[v]))}),d},s=(l,c)=>{const u=l;return c==="start"&&l.forEach(d=>{for(;d.length<4;)d.push(0)}),c==="end"&&l.forEach(d=>{for(;d.length<4;)d.unshift(0)}),u},a=l=>{let c=l;const u=d(l);if(u.length){const i=_(u),v=f(),G=u[i][0],N=u[i][1];c[G][N]=v}return c;function d(i){const v=[];for(let G=0;G<i.length;G++)for(let N=0;N<i.length;N++)i[G][N]===0&&v.push([G,N]);return v}},r=()=>{const l=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],c=[];for(let d=0;c.length<2;d++){const i=u(3),v=u(3);c.length<1?c.push([i,v]):i!==c[0][0]&&v!==c[0][1]&&c.push([i,v])}for(let d of c){const i=d[0],v=d[1];l[i][v]=f()}return l;function u(d){return Math.floor(Math.random()*(Math.floor(d)+1))}};function f(){return Math.random()>.2?2:4}function _(l){const c=l.length-1;return Math.floor(Math.random()*(Math.floor(c)+1))}return{getCells:e,getReversedCells:t,getCellsWithoutZeros:n,getCellsWithZeros:s,getUnitedCells:o,getCellsWithNewRandomNumber:a,getStaterCells:r}};var m=(e=>(e.THEME="THEME",e.GAME_CONTROLLER="GAME_CONTROLLER",e.CELLS="CELLS",e.GAME_STATE="GAME_STATE",e.CURRENT_SCORE="CURRENT_SCORE",e.RECORD_SCORE="RECORD_SCORE",e))(m||{});const E=()=>({get:s=>window.localStorage.getItem(s),set:(s,a)=>window.localStorage.setItem(s,a),remove:s=>window.localStorage.removeItem(s),reset:()=>window.localStorage.clear()}),k=D("cells",()=>{const e=E(),t=I(),{getStaterCells:n}=X(),o=p([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),s=h(()=>o.value),a=p(o.value),r=p(!1),f=h(()=>r.value),_=p(0),l=i=>{a.value=o.value,r.value=!0,o.value=i,e.set(m.CELLS,JSON.stringify(o.value))},c=()=>{const i=I();r.value=!1,o.value=n(),e.set(m.CELLS,JSON.stringify(o.value)),i.resetCurrentScore()},u=()=>{f.value&&(o.value=a.value,e.set(m.CELLS,JSON.stringify(o.value)),t.setPrevScore()),d(!1)},d=i=>{r.value=i};return{cells:o,prevCells:a,score:_,getCells:s,getPrevCellsState:f,setCells:l,setStarterCells:c,setPrevCells:u,setPrevCellsState:d}}),Z=D("controller",()=>{const e=E(),t=p("mouse"),n=h(()=>t.value);return{controller:t,getController:n,setController:s=>{t.value=s,e.set(m.GAME_CONTROLLER,t.value)}}}),W=D("game",()=>{const e=E(),t=p("active"),n=h(()=>t.value);return{gameState:t,getGameState:n,setGameState:s=>{t.value=s,e.set(m.GAME_STATE,t.value)}}}),I=D("score",()=>{const e=E(),t=p(0),n=p(0),o=p(0),s=h(()=>t.value),a=h(()=>n.value);H(t,()=>{t.value>n.value&&f(t.value)});const r=u=>{t.value=u,e.set(m.CURRENT_SCORE,JSON.stringify(t.value))},f=u=>{n.value=u,e.set(m.RECORD_SCORE,JSON.stringify(n.value))};return{currentScore:t,recordScore:n,getCurrentScore:s,getRecordScore:a,setCurrentScore:r,setRecordScore:f,increaseCurrentScore:u=>{o.value=t.value,r(t.value+u)},resetCurrentScore:()=>{r(0)},setPrevScore:()=>{r(o.value)}}}),re=$({components:{SvgIcon:T},setup(){const e=E(),t=k(),n=W(),o=I(),s=h(()=>t.getPrevCellsState),a=h(()=>o.getCurrentScore),r=h(()=>o.getRecordScore);return M(()=>{if(e.get(m.CURRENT_SCORE)){const l=e.get(m.CURRENT_SCORE);Number(l)&&o.setCurrentScore(Number(l))}if(e.get(m.RECORD_SCORE)){const l=e.get(m.RECORD_SCORE);Number(l)&&o.setRecordScore(Number(l))}}),{prevCellsState:s,currentScore:a,recordScore:r,restartGame:()=>{t.setStarterCells(),n.setGameState("active")},setPrevStep:()=>{t.setPrevCells(),n.setGameState("active")}}}});const se={class:"header"},ce=g("h1",{class:"title"},"2048",-1),le={class:"score"},ae=g("span",{class:"score-header"},"Current score: ",-1),ie={class:"score-value"},ue={class:"score record"},de=g("span",{class:"score-header record-header"},"Record: ",-1),fe={class:"score-value record-value"},me={class:"controllers"};function ve(e,t,n,o,s,a){const r=w("svg-icon");return C(),R("div",se,[ce,g("div",le,[ae,g("p",ie,x(e.currentScore),1)]),g("div",ue,[de,g("p",fe,x(e.recordScore),1)]),g("div",me,[S(r,{onClick:e.setPrevStep,disabled:!e.prevCellsState,name:"backward",height:26,width:26},null,8,["onClick","disabled"]),S(r,{onClick:e.restartGame,name:"rotate-right",height:26,width:26},null,8,["onClick"])])])}const _e=b(re,[["render",ve]]),he=$({props:{value:{type:Number,required:!0}},setup(e){const t=h(()=>e.value===0?"":e.value),n=h(()=>e.value===2?"first":e.value===4?"second":e.value===8?"third":e.value===16?"fourth":e.value===32?"fifth":e.value===64?"sixth":e.value===128?"seventh":e.value===256?"eighth":e.value===512?"ninth":e.value===1024?"tenth":e.value===2048?"eleventh":e.value===4096?"twelfth":e.value===8192?"thirteenth":e.value===16384?"fourteenth":e.value===32768?"fifteenth":"empty");return{number:t,color:n}}});const ge={class:"number-container"};function Ce(e,t,n,o,s,a){return C(),R("div",ge,[g("div",{class:B(["number",e.color])},x(e.number),3)])}const pe=b(he,[["render",Ce],["__scopeId","data-v-389bb05f"]]),J=()=>{const e=p(window.innerWidth);return window.addEventListener("resize",()=>e.value=window.innerWidth),e},U=J();let O=90;V(U);H(U,()=>{V(U)});function V(e){e.value<=540?O=60:O=90}const Se=(e,t)=>{let n,o;return"clientX"in e?(n=e==null?void 0:e.clientX,o=e==null?void 0:e.clientY):(n=e==null?void 0:e.touches[0].clientX,o=e==null?void 0:e.touches[0].clientY),t.startX-n>=O?"left":t.startX-n<=-O?"right":t.startY-o>=O?"up":t.startY-o<=-O?"down":null},L=e=>{const t=k(),n=h(()=>t.getCells),{getReversedCells:o}=X();switch(e){case"left":return s(n.value,"left");case"right":return s(n.value,"right");case"up":{const a=o(n.value);return s(a,"up")}case"down":{const a=o(n.value);return s(a,"down")}}function s(a,r){if(r==="left"||r==="up"){for(let c of a)if(f(c)||l(c))return!0}else if(r==="right"||r==="down"){for(let c of a)if(_(c)||l(c))return!0}return!1;function f(c){const u=c.indexOf(0);let d=-1;for(let i=0;i<c.length;i++)c[i]&&(d=i);return d!==-1&&u!==-1?d>u:!1}function _(c){const u=c.lastIndexOf(0);let d=-1;for(let i=c.length-1;i>=0;i--)c[i]&&(d=i);return d!==-1&&u!==-1?d<u:!1}function l(c){for(let u=1;u<c.length;u++)if(c[u]===c[u-1]&&c[u]!==0)return!0;return!1}}return!1},we=()=>({swipeLeft:()=>A("left"),swipeRight:()=>A("right"),swipeUp:()=>A("up"),swipeDown:()=>A("down")});function A(e){const t=k(),n=h(()=>t.getCells),{getCells:o,getReversedCells:s,getCellsWithoutZeros:a,getCellsWithZeros:r,getUnitedCells:f,getCellsWithNewRandomNumber:_}=X();let l,c;e==="up"||e==="down"?l=s(n.value):l=o(n.value),e==="left"||e==="up"?c="start":c="end",l=a(l),l=f(l,c),l=a(l),l=r(l,c),(e==="up"||e==="down")&&(l=s(l)),l=_(l),t.setCells(l)}const q=e=>{const{swipeLeft:t,swipeRight:n,swipeUp:o,swipeDown:s}=we(),a=W();switch(e){case"left":L("left")&&t();break;case"right":L("right")&&n();break;case"up":L("up")&&o();break;case"down":L("down")&&s();break}!L("left")&&!L("right")&&!L("up")&&!L("down")&&a.setGameState("over")},y=(e,t)=>{const n=Z(),o=h(()=>n.getController);if(o.value==="keyboard")"code"in e&&!e.ctrlKey&&Ee(e);else if(o.value==="mouse"){let s=0,a=0;"clientX"in e?(s=e.clientX,a=e.clientY):"touches"in e&&(s=e==null?void 0:e.touches[0].clientX,a=e==null?void 0:e.touches[0].clientY);const r=f=>{const _=Se(f,{startX:s,startY:a});_&&(q(_),t.removeEventListener("mousemove",r,!1),t.removeEventListener("touchmove",r,!1))};t.addEventListener("mousemove",r),t.addEventListener("touchmove",r),t.onmouseup=()=>{t.removeEventListener("mousemove",r),t.onmouseup=null},t.ontouchend=()=>{t.removeEventListener("touchmove",r),t.ontouchend=null}}},Ee=e=>{let t=null;(e.code==="ArrowUp"||e.code==="KeyW")&&(t="up"),(e.code==="ArrowRight"||e.code==="KeyD")&&(t="right"),(e.code==="ArrowDown"||e.code==="KeyS")&&(t="down"),(e.code==="ArrowLeft"||e.code==="KeyA")&&(t="left"),t&&q(t)},Re=$({components:{NumberComponent:pe},setup(){const e=E(),t=k(),n=p(null),o=h(()=>t.getCells),s=h(()=>o.value.reduce((a,r)=>[...a,...r],[]));return M(()=>{var a,r,f;e.get(m.CELLS)?t.setCells(JSON.parse(e.get(m.CELLS))):t.setStarterCells(),t.setPrevCellsState(!1),(a=n.value)==null||a.addEventListener("mousedown",_=>y(_,n.value)),(r=n.value)==null||r.addEventListener("touchstart",_=>y(_,n.value)),window.addEventListener("keydown",_=>y(_,n.value)),(f=n.value)==null||f.addEventListener("dragstart",()=>!1)}),j(()=>{var a,r,f;(a=n.value)==null||a.removeEventListener("mousedown",()=>y,!1),(r=n.value)==null||r.removeEventListener("touchstart",()=>y,!1),(f=n.value)==null||f.removeEventListener("dragstart",()=>!1,!1)}),{playgroundCells:s,cells:o,playgroundRef:n}}});const $e={class:"game-over",ref:"playgroundRef"};function be(e,t,n,o,s,a){const r=w("number-component");return C(),R("div",$e,[(C(!0),R(K,null,Q(e.playgroundCells,(f,_)=>(C(),P(r,{key:_,value:f},null,8,["value"]))),128))],512)}const Y=b(Re,[["render",be]]),Le=$({components:{SvgIcon:T},setup(){const e=Z(),t=E(),n=J(),o=h(()=>e.controller);M(()=>a());const s=r=>{e.setController(r)},a=()=>{if(n.value<=540)e.setController("mouse");else if(t.get(m.GAME_CONTROLLER)==="keyboard"||t.get(m.GAME_CONTROLLER)==="mouse"){const r=t.get(m.GAME_CONTROLLER);e.setController(r)}};return H(n,a),{controller:o,screenWidth:n,setController:a,switchController:s}}});const Ge={key:0,class:"controllers"};function Ne(e,t,n,o,s,a){const r=w("svg-icon");return e.screenWidth>540?(C(),R("div",Ge,[g("span",{onClick:t[0]||(t[0]=f=>e.switchController("keyboard"))},[S(r,{height:30,width:30,name:"keyboard",active:e.controller==="keyboard"},null,8,["active"])]),g("span",{onClick:t[1]||(t[1]=f=>e.switchController("mouse"))},[S(r,{height:30,width:30,name:"computer-mouse",active:e.controller==="mouse"},null,8,["active"])])])):ee("",!0)}const Oe=b(Le,[["render",Ne],["__scopeId","data-v-027d590b"]]),ye=$({components:{SvgIcon:T},setup(){const e=k(),t=W();return{restartGame:()=>{e.setStarterCells(),t.setGameState("active")}}}});const Me={class:"game-over-banner"},Te=g("span",{class:"game-over-banner__text"},"Game Over",-1);function ke(e,t,n,o,s,a){const r=w("svg-icon");return C(),R("div",Me,[Te,S(r,{onClick:e.restartGame,name:"rotate-right",height:80,width:80},null,8,["onClick"])])}const z=b(ye,[["render",ke]]),Ae=$({components:{SvgIcon:T,GameHeader:_e,GamePlayground:Y,GameController:Oe,GameOver:z},setup(){const e=W(),t=E(),n=h(()=>e.getGameState),o=h(()=>n.value==="over"?z:Y);return M(()=>{if(t.get(m.GAME_STATE)==="active"||t.get(m.GAME_STATE)==="over"){const s=t.get(m.GAME_STATE);e.setGameState(s)}}),{gameState:n,gameComponent:o}}});const Ie={class:"game"};function De(e,t,n,o,s,a){const r=w("game-header"),f=w("game-controller");return C(),R("div",Ie,[S(r),(C(),P(te(e.gameComponent))),S(f)])}const We=b(Ae,[["render",De],["__scopeId","data-v-3dd57da1"]]),xe=$({name:"ThemeSwitcher",components:{SvgIcon:T},setup(){const e=E();M(()=>{n()});const t=()=>{e.get(m.THEME)==="light"?e.set(m.THEME,"dark"):e.set(m.THEME,"light"),n()},n=()=>{const s=E();s.get(m.THEME)?s.get(m.THEME)==="dark"?o("dark"):o("light"):window!=null&&window.matchMedia("(prefers-color-scheme: light)").matches?(s.set(m.THEME,"light"),o("light"),n()):(s.set(m.THEME,"dark"),o("dark"),n())},o=s=>{document.documentElement.setAttribute("data-theme",s)};return{switchTheme:t}}});function Ue(e,t,n,o,s,a){const r=w("svg-icon");return C(),P(r,{onClick:e.switchTheme,name:"lightbulb",width:40,height:40},null,8,["onClick"])}const He=b(xe,[["render",Ue]]),Pe=$({name:"MainView",components:{ThemeSwitcher:He,GameContainer:We}}),Xe={class:"main"};function Ye(e,t,n,o,s,a){const r=w("theme-switcher"),f=w("game-container");return C(),R("main",Xe,[S(r),S(f)])}const Be=b(Pe,[["render",Ye]]);export{Be as default};
